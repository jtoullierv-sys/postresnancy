<app-header></app-header>

<ion-content class="ion-padding">

  <!-- SEGMENTO SUPERIOR -->
  <div class="segmento-container">
    <ion-segment [value]="segmento" (ionChange)="cambiarSegmento($event)">
      <ion-segment-button value="activos">Activos</ion-segment-button>
      <ion-segment-button value="cancelados">Cancelados</ion-segment-button>
      <ion-segment-button value="finalizados">Finalizados</ion-segment-button>
    </ion-segment>
  </div>

  <!-- üü¢ PEDIDOS ACTIVOS -->
  <ng-container *ngIf="segmento === 'activos'">
    <ion-card *ngFor="let pedido of pedidosActivos" class="pedido-card">

      <ion-card-header>
        <ion-card-title>üç∞ Pedido #{{ pedido.id_pedido }}</ion-card-title>
      </ion-card-header>

      <ion-card-content>

        <!-- Lista de etapas -->
        <ion-list class="etapas-list" lines="none">
          <ion-item *ngFor="let etapa of etapas; let paso = index">
            <ion-badge [color]="obtenerColor(pedido.id_estadopedido, paso + 1)">
              {{ paso + 1 }}
            </ion-badge>
            <ion-label>{{ etapa }}</ion-label>
          </ion-item>
        </ion-list>

        <!-- Informaci√≥n adicional -->
        <p><strong>Total pagado:</strong> S/ {{ pedido.total_pagado }}</p>
        <p><strong>Contacto:</strong> {{ pedido.contacto_pedido }}</p>
        <p><strong>Entrega:</strong> {{ pedido.fecha_entrega }} - {{ pedido.hora_entrega }}</p>

        <!-- Botones -->
        <div class="botones-acciones">
          <ion-button fill="outline" color="primary" (click)="verRecibo(pedido.id_pedido)">
            <ion-icon slot="start" name="receipt-outline"></ion-icon>
            Ver Recibo
          </ion-button>

          <ion-button fill="outline" color="danger" (click)="cancelarPedido(pedido.id_pedido)">
            <ion-icon slot="start" name="trash"></ion-icon>
            Cancelar
          </ion-button>
        </div>

      </ion-card-content>

    </ion-card>
  </ng-container>

  <!-- üî¥ PEDIDOS CANCELADOS -->
  <ng-container *ngIf="segmento === 'cancelados'">
    <ion-card *ngFor="let pedido of pedidosCancelados" class="pedido-card">
      <ion-card-header>
        <ion-card-title>Pedido Cancelado #{{ pedido.id_pedido }}</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <p class="cancelado-texto">Este pedido fue cancelado.</p>

        <p><strong>Total:</strong> S/ {{ pedido.total_pagado }}</p>
        <p><strong>Contacto:</strong> {{ pedido.contacto_pedido }}</p>
      </ion-card-content>
    </ion-card>
  </ng-container>

  <!-- üü¢ PEDIDOS FINALIZADOS -->
  <ng-container *ngIf="segmento === 'finalizados'">
    <ion-card *ngFor="let pedido of pedidosFinalizados" class="pedido-card">

      <ion-card-header>
        <ion-card-title>Pedido Finalizado #{{ pedido.id_pedido }}</ion-card-title>
      </ion-card-header>

      <ion-card-content class="ion-text-center finalizado-boton">

        <p><strong>Entrega:</strong> {{ pedido.fecha_entrega }} - {{ pedido.hora_entrega }}</p>

        <ion-button fill="outline" color="success" (click)="reclamarPedido(pedido.id_pedido)">
          <ion-icon slot="start" name="alert-circle-outline"></ion-icon>
          Reclamar
        </ion-button>
      </ion-card-content>

    </ion-card>
  </ng-container>

</ion-content>

<app-footer></app-footer>
